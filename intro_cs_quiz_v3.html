<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Intro to Computer Science – امتحان تفاعلي</title>
  <!-- AOS (Animate On Scroll) -->
  <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet" />
  <script defer src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <style>
    :root{--bg:#0f172a;--card:#0b1228;--muted:#94a3b8;--text:#e5e7eb;--accent:#22d3ee;--vio:#a78bfa;--ok:#10b981;--bad:#ef4444;--warn:#f59e0b}
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0b1023,#0f172a 25%,#0b1023 100%);color:var(--text);font-family:"Cairo",system-ui,-apple-system,Segoe UI,Roboto,"Noto Kufi Arabic",Tahoma,Arial}
    a{color:var(--accent)}
    header{position:sticky;top:0;z-index:40;background:rgba(15,23,42,.78);backdrop-filter:blur(10px);border-bottom:1px solid rgba(148,163,184,.15)}
    .container{max-width:1150px;margin:0 auto;padding:12px 16px}
    /* Top bar */
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .brand{display:flex;align-items:center;gap:10px}
    .brand svg{flex:0 0 auto}
    .brand h1{margin:0;font-size:20px}
    .hamburger{display:none;flex:0 0 auto;border:1px solid rgba(148,163,184,.3);background:#0b1228;border-radius:10px;padding:8px 10px;cursor:pointer}
    .hamburger span{display:block;width:20px;height:2px;background:#cbd5e1;margin:4px 0;border-radius:2px}
    .badge{padding:3px 8px;border:1px solid rgba(148,163,184,.25);border-radius:999px;font-size:12px;color:var(--muted)}
    .panel{margin-top:10px}
    .controls{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
    .card{background:linear-gradient(180deg,#0d1228,#0b1023);border:1px solid rgba(148,163,184,.13);border-radius:16px;padding:14px}
    select,button{width:100%;padding:10px 12px;border-radius:12px;border:1px solid rgba(148,163,184,.25);background:#0b1228;color:var(--text)}
    button{cursor:pointer;border:1px solid rgba(34,211,238,.45);background:linear-gradient(180deg,#06222a,#08242c)}
    button.primary{border-color:rgba(34,211,238,.7);background:linear-gradient(180deg,#043039,#06323a)}
    button.secondary{border-color:rgba(167,139,250,.55)}
    button.ghost{border-color:rgba(148,163,184,.25)}
    .hint{color:var(--muted);font-size:13px}
    .q-card{margin:14px 0;border:1px solid rgba(148,163,184,.12);border-radius:14px;overflow:hidden}
    .q-head{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;background:rgba(148,163,184,.06)}
    .q-body{padding:14px}
    .q-index{font-weight:700;color:var(--accent)}
    .tag{font-size:11px;color:#a5b4fc;padding:2px 8px;border:1px solid rgba(165,180,252,.35);border-radius:999px}
    .options{display:grid;gap:10px;margin-top:10px}
    .opt{display:flex;gap:10px;align-items:flex-start;padding:10px 12px;border:1px solid rgba(148,163,184,.18);border-radius:12px;background:#0b1228}
    .opt input{margin-top:4px}
    .result-bar{margin-top:16px;display:flex;gap:12px;flex-wrap:wrap}
    .pill{padding:6px 12px;border-radius:999px;font-weight:600}
    .pill.ok{background:rgba(16,185,129,.15);color:#34d399;border:1px solid rgba(16,185,129,.35)}
    .pill.bad{background:rgba(239,68,68,.12);color:#f87171;border:1px solid rgba(239,68,68,.35)}
    .pill.warn{background:rgba(245,158,11,.12);color:#fbbf24;border:1px solid rgba(245,158,11,.35)}
    .pill.info{background:rgba(167,139,250,.12);color:#c4b5fd;border:1px solid rgba(167,139,250,.35)}
    .correct{outline:2px solid rgba(16,185,129,.55)}
    .incorrect{outline:2px solid rgba(239,68,68,.55)}
    .explain{margin-top:8px;color:#c7d2fe;font-size:13px}
    .footer-actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:16px}
    .sticky-cta{position:sticky;bottom:0;background:rgba(15,23,42,.85);backdrop-filter:blur(8px);padding:12px;border-top:1px solid rgba(148,163,184,.15)}
    .small{font-size:12px;color:var(--muted)}
    footer{margin:40px auto 24px;text-align:center;color:#9ca3af}

    /* Hamburger behavior on mobile */
    @media (max-width: 768px){
      .badge{display:none}
      .brand h1{font-size:18px}
      .hamburger{display:inline-block}
      .panel{display:none} /* collapsed by default on mobile */
      .controls{grid-template-columns:1fr}
      .card{padding:12px}
      .q-head{padding:10px 12px}
      .q-body{padding:12px}
    }
    .panel.open{display:block !important}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="topbar">
        <div class="brand">
          <svg width="26" height="26" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M12 3l7 4v6c0 5-3.5 7.5-7 8-3.5-.5-7-3-7-8V7l7-4z" stroke="url(#g)" stroke-width="1.2" fill="none"/>
            <defs><linearGradient id="g" x1="0" y1="0" x2="24" y2="24"><stop stop-color="#22d3ee"/><stop offset="1" stop-color="#a78bfa"/></linearGradient></defs>
          </svg>
          <h1>Intro to Computer Science – امتحان تفاعلي</h1>
          <span class="badge">AOS · Responsive</span>
        </div>
        <button id="hamburger" class="hamburger" aria-label="Toggle menu">
          <span></span><span></span><span></span>
        </button>
      </div>
      <div id="panel" class="panel">
        <div class="controls">
          <div class="card" style="grid-column: span 7">
            <label class="hint">اختَر الفصل لعرض الأسئلة:</label>
            <select id="chapterFilter">
              <option value="all">كل الفصول</option>
              <option value="1">Chapter 1</option>
              <option value="2">Chapter 2</option>
              <option value="3">Chapter 3</option>
              <option value="4">Chapter 4</option>
              <option value="5">Chapter 5</option>
              <option value="6">Chapter 6</option>
              <option value="7">Chapter 7</option>
              <option value="9">Chapter 9</option>
              <option value="11">Chapter 11</option>
            </select>
            <div class="small" style="margin-top:6px">الأسئلة مدمجة كما أرسلتها — لا تحتاج للصق أي شيء.</div>
          </div>
          <div class="card" style="grid-column: span 5">
            <label class="hint">الترتيب</label>
            <button id="shuffleBtn" class="secondary" style="width:100%">ترتيب عشوائي</button>
            <div class="small" style="margin-top:6px">للتنويع بين المحاولات.</div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <div id="questions"></div>
    <div class="sticky-cta">
      <div class="footer-actions">
        <button id="submitBtn" class="primary">تصحيح & عرض الدرجة</button>
        <button id="retryBtn" class="ghost">إعادة المحاولة</button>
        <button id="wrongBtn" class="secondary" style="display:none">اعرض الغلط فقط</button>
        <button id="allBtn" class="ghost" style="display:none">اعرض الكل</button>
      </div>
      <div id="summary" class="result-bar"></div>
    </div>
    <footer>صُنِعت بالحب بواسطة جيمي ❤️</footer>
  </main>

  <script>
    // ===== AOS init =====
    document.addEventListener('DOMContentLoaded', ()=> AOS.init({ once:false, duration:600, easing:'ease-out-cubic'}));

    const byId = (x)=>document.getElementById(x);
    const panel = byId('panel');
    byId('hamburger').addEventListener('click', ()=> panel.classList.toggle('open'));

    let BANK = []; // parsed from RAW

    function render(){
      const wrap = byId('questions');
      wrap.innerHTML = '';
      const chapSel = byId('chapterFilter').value;
      const list = BANK.filter(q=> chapSel==='all' ? true : String(q.chapter)===chapSel);
      list.forEach((q)=>{
        const card = document.createElement('div');
        card.className='q-card';
        card.dataset.qid = q.uid;
        card.setAttribute('data-aos','fade-up');
        const head = document.createElement('div'); head.className='q-head';
        head.innerHTML = `<div><span class="q-index">سؤال ${q.uid}</span> · <span class="tag">Ch ${q.chapter} · ${q.type.toUpperCase()}</span></div>`;
        const body = document.createElement('div'); body.className='q-body';
        const p = document.createElement('p'); p.textContent = q.q; body.appendChild(p);
        const opts = document.createElement('div'); opts.className='options';
        const letters = q.type==='tf' ? ['T','F'] : ['A','B','C','D'];
        letters.forEach((L,idx)=>{
          const label = document.createElement('label'); label.className='opt';
          const inp = document.createElement('input'); inp.type='radio'; inp.name='q'+q.uid; inp.value=L;
          const span = document.createElement('div');
          span.textContent = (q.type==='tf')? (L==='T'?'True (صح)':'False (خطأ)') : (L+'. '+(q.options[idx]||''));
          label.appendChild(inp); label.appendChild(span); opts.appendChild(label);
        });
        body.appendChild(opts);
        const exp = document.createElement('div'); exp.className='explain'; exp.style.display='none'; body.appendChild(exp);
        card.appendChild(head); card.appendChild(body); wrap.appendChild(card);
      });
      AOS.refreshHard();
      byId('summary').innerHTML = '';
      byId('wrongBtn').style.display='none'; byId('allBtn').style.display='none';
    }

    function grade(){
      let correct=0, wrong=0, blank=0, gradable=0, unkeyed=0;
      const chapSel = byId('chapterFilter').value;
      const list = BANK.filter(q=> chapSel==='all' ? true : String(q.chapter)===chapSel);
      list.forEach((q)=>{
        const card = document.querySelector(`[data-qid="${q.uid}"]`);
        if(!card) return;
        const labels = [...card.querySelectorAll('label.opt')];
        const selected = labels.find(l=>l.querySelector('input').checked)?.querySelector('input').value;
        const key = (q.key||'').toUpperCase();
        const exp = card.querySelector('.explain');
        // reset classes
        labels.forEach(l=>l.classList.remove('correct','incorrect'));

        if(!key){
          unkeyed++;
          // Show chosen (if any) in red? user asked only mark wrong when key known. We'll just show note.
          exp.style.display=''; exp.textContent='(بدون مفتاح — غير محسوب في الدرجة)';
          return;
        }

        // Always mark correct option in green
        const right = labels.find(l=>l.querySelector('input').value===key);
        if(right) right.classList.add('correct');

        gradable++;
        if(!selected){
          blank++; exp.style.display=''; exp.textContent = `الإجابة الصحيحة: ${key}`; return;
        }
        if(selected===key){
          correct++; exp.style.display=''; exp.textContent='إجابة صحيحة ✔️';
        }else{
          wrong++; exp.style.display=''; exp.textContent=`إجابتك خاطئة ❌ · الصحيحة: ${key}`;
          const wrongLab = labels.find(l=>l.querySelector('input').value===selected);
          if(wrongLab) wrongLab.classList.add('incorrect');
        }
      });
      const score = gradable? Math.round((correct/gradable)*100):0;
      byId('summary').innerHTML = `
        <span class="pill ok">✅ صح: ${correct}</span>
        <span class="pill bad">❌ غلط: ${wrong}</span>
        <span class="pill warn">⚠️ بدون إجابة: ${blank}</span>
        <span class="pill info">ℹ️ غير محسوب: ${unkeyed}</span>
        <span class="pill" style="border:1px solid rgba(34,211,238,.45);background:rgba(34,211,238,.12);color:#67e8f9">الدرجة: ${score} / 100</span>`;
      byId('wrongBtn').style.display = (wrong+blank>0)? 'inline-flex':'none';
      byId('allBtn').style.display = 'none';
    }

    function showWrong(){
      const chapSel = byId('chapterFilter').value;
      const list = BANK.filter(q=> chapSel==='all' ? true : String(q.chapter)===chapSel);
      list.forEach((q)=>{
        const card = document.querySelector(`[data-qid="${q.uid}"]`);
        const labels = [...card.querySelectorAll('label.opt')];
        const selected = labels.find(l=>l.querySelector('input').checked)?.querySelector('input').value;
        const key = (q.key||'').toUpperCase();
        const isWrong = (!selected) || (key && selected!==key);
        if(card) card.style.display = isWrong? '':'';
      });
      byId('wrongBtn').style.display='none'; byId('allBtn').style.display='inline-flex';
    }
    function showAll(){ document.querySelectorAll('.q-card').forEach(c=>c.style.display=''); byId('allBtn').style.display='none'; byId('wrongBtn').style.display='inline-flex'; }

    byId('chapterFilter').addEventListener('change', ()=>{ render(); window.scrollTo({top:0,behavior:'smooth'}); });
    byId('shuffleBtn').addEventListener('click', ()=>{ BANK = BANK.sort(()=>Math.random()-.5); render(); });
    byId('submitBtn').addEventListener('click', ()=>{ grade(); window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'}); });
    byId('retryBtn').addEventListener('click', ()=>{ document.querySelectorAll('input[type=radio]').forEach(i=>i.checked=false); byId('summary').innerHTML=''; byId('wrongBtn').style.display='none'; byId('allBtn').style.display='none'; window.scrollTo({top:0,behavior:'smooth'}); });
    byId('wrongBtn').addEventListener('click', showWrong); byId('allBtn').addEventListener('click', showAll);

    // ========= RAW TEXT =========
    // مهم: حط أسئلتك الكاملة هنا مكان هذا النص (نفس التنسيق اللي بعتّه).
    const RAW = String.raw`CHAPTER 1:
Computer ______ entails having knowledge and understanding of computers and their uses.
a. literacy
b. intimacy
c. legitimacy
d. infancy
الإجابة: A

A(n) ______ is an electronic device, operating under the control ...
a. input device
b. computer
c. output device
d. both a and c
الإجابة: B

True/False:
You interact with a program through its user interface.
T (True)

CHAPTER 2:
The ______ is a worldwide collection of networks ...
a. Internet
b. microblog
c. Web
d. NSFNet

... ضع باقي الأسئلة كاملة كما أرسلتها ...

CHAPTER 6:
______ storage is the physical material on which a computer keeps data, instructions, and information.
a. Primary
b. Secondary
c. Tertiary
d. All of the above
الإجابة: B

... الخ ...

CHAPTER 11:
A(n) ______ is a set of components that interact to achieve a common goal.
a. system
b. feature
c. implementation
d. function
الإجابة: A
`;

    // ===== Robust Parser =====
    function parseRaw(raw){
      const lines = raw.split(/\r?\n/);
      let chapter = null;
      let uid = 0;
      const items = [];
      function pushMCQ(qtext, opts, key){
        uid++; items.push({uid, chapter, type:'mcq', q:qtext.trim(), options:opts, key:(key||'')});
      }
      function pushTF(qtext, key){
        uid++; items.push({uid, chapter, type:'tf', q:qtext.trim(), options:[], key:(key||'')});
      }
      for(let i=0;i<lines.length;i++){
        let s = lines[i].trim();
        const chm = s.match(/^chapter\s*(\d+)/i) || s.match(/^CHAPTER\s*(\d+)/i);
        if(chm){ chapter = Number(chm[1]); continue; }
        if(!s) continue;

        // True/False: statement line then T/F line
        if(/[.؟?…:]$/.test(s) && (lines[i+1]||'').match(/^\s*[TF]\s*\(/)){
          const k = lines[i+1].trim().startsWith('T')?'T':'F';
          pushTF(s.replace(/[:：]\s*$/,''), k);
          i++;
          continue;
        }

        // MCQ block: question then a./b./c./d.
        if((lines[i+1]||'').match(/^[a-dA-D]\.\s/)){
          const qtext = s.replace(/[:：]\s*$/,'');
          const opts = [];
          let j = 1;
          while((lines[i+j]||'').trim().match(/^[a-dA-D]\.\s/)){
            const m = (lines[i+j]||'').trim().match(/^[a-dA-D]\.\s*(.*)$/);
            if(m){ opts.push(m[1]); }
            j++;
          }
          // Look for answer line within next 5 lines
          let key = '';
          for(let k=0;k<5;k++){
            const ans = (lines[i+j+k]||'').trim().match(/^الإجابة\s*:\s*([A-DTF])/);
            if(ans){ key = ans[1].toUpperCase(); break; }
          }
          pushMCQ(qtext, opts, key);
          i += (j-1);
          continue;
        }

        // Standalone "الإجابة: X"
        const loneAns = s.match(/^الإجابة\s*:\s*([A-DTF])/);
        if(loneAns && items.length){
          items[items.length-1].key = loneAns[1].toUpperCase();
          continue;
        }
      }
      return items;
    }

    BANK = parseRaw(RAW);
    render();
  </script>
</body>
</html>
